# arbell-php-test
Technical test done in May/June 2025

Created with
* Symfony 7.3
* Tabler 1.3.2

Also used
* [MariaDB](https://mariadb.org)
* [Symfony Profiler](https://symfony.com/doc/current/profiler.html)

## Branch
This is the `web` branch, which contains a site for basic User CRUD operations.

## Composer packages
Run `composer install` to install all required packages

## Some technical details
* The project is done in Symfony to take advantage of their roles and permissions capabilities.
* Role names follow the `ROLE_[NAME]` convention used in Symfony and are managed through the `RoleEnum` enum to avoid any confusion.
* The database is MariaDB, the open source version of MySql. It is possible to switch to MySql, just update the url as explained later in this document.

### Database entity-relation diagram
![Diagram generated by phpMyAdmin](/screenshots/arbell-test%20-%20ERD.png)
Note: doctrine_migration_versions is an internal table used to keep track of executed migrations.

## Environment variables
All envirnoment variables are managed using a .env file. In this case we need to set up at least two variables before running the project for the first time
* `APP_ENV` to point which environment we are using. By default is set to `dev`.
* `DATABASE_URL` to connect with the MySql/MariaDB database. The value for MariaDB versions from 10.11.2 is `mysql://[USER]:[PASSWORD]@[DB_URL]:[DB_PORT]/[DB_NAME]?serverVersion=10.11.2-MariaDB&charset=utf8mb4` where
    * `USER` is a valid database engine user, with at least reading and writing permissions
    * `PASSWORD` is the user password
    * `DB_URL` is the url used by the database engine. For local environments, the default is `localhost`
    * `DB_PORT` is the port used by the database engine for listening. For local environment, the default is `3306`
    * `DB_NAME` is the database name

For MySql databases, use `DATABASE_URL="mysql://[USER]:[PASSWORD]@[DB_URL]:[DB_PORT]/[DB_NAME]`.

For older MariaDB versions or other databases, go to [Databases and the Doctrine ORM](https://symfony.com/doc/current/doctrine.html#configuring-the-database) in the official Symfony documentation.

## Test data
Run `php bin/console doctrine:database:create` to create an empty database. Note that this command will fail if the database user does not have creating permissions.

Run `php bin/console make:migrations:migrate` to create all the database tables and fill them with test data.

Test data consists of the two profiles, one with role `ROLE_ADMIN` and other with role `ROLE_USER`, and one user, `admin@example.com` with admin capabilities and password `test123`.

## Running locally
For local development, we can use the [Symfony binary](https://symfony.com/download) to run the local server.

Once the binary is installed, run `php bin/console asset-map:compile --no-debug` to compile all assets, followed by `symfony server:start`. If this last command does not work, check where the symfony binary is located. For Linux systems the default location is `$HOME/.symfony/bin`.

By default, the site is available at `http://localhost:8000/`.

## Screenshots
### Home page
#### Without being logged in
![Without being logged in](/screenshots/Homepage%20-%20not%20logged%20in.png)

#### Logged in
![Logged in](/screenshots/Homepage%20-%20logged%20in.png)

### Login
![Login](/screenshots/Log%20in.png)

### List
![User index](/screenshots/User%20index.png)

### Creation
![New user form](/screenshots/New%20User%20form.png)
![Message after creating user](/screenshots/User%20index%20-%20user%20created.png)

### Details
![User details](/screenshots/User%20details.png)

### Edit
![Edit user form](/screenshots/Edit%20User.png)
![Change password form](/screenshots/Edit%20User%20-%20update%20password%20.png)
![Message after updating user](/screenshots/User%20index%20-%20password%20updated.png)

### Deletion
![Delete user modal](/screenshots/User%20index%20-%20delete%20user%20modal.png)
![Message after deleting user](/screenshots/User%20index%20-%20user%20deleted.png)

### Access denied
![User list access denied](/screenshots/User%20list%20-%20no%20authorization.png)

### User deletion denied
![User deletion denied](/screenshots/User%20delete%20-%20no%20authorization.png)

### Mobile (iPad 810x1080)
![Mobile (iPad 810x1080)](/screenshots/User%20index%20-%20iPad.png)